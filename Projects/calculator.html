<!DOCTYPE html>
<html lang="en">

<head>
  <link rel="stylesheet" href="calculator.css">
  <title>Calculator</title>
</head>

<body>
  <div id="calculator">
    <input type="text" id="display" readonly placeholder="0">
    <div class="button-container">
      <button class="button b-sp-color" onclick="
      currentDisplay = '';
      document.querySelector('#display').value = currentDisplay;
      ">AC</button>
      <button class="button b-sp-color" onclick="
      currentDisplay = currentDisplay.slice(0, -1);
      document.querySelector('#display').value = currentDisplay;
      ">DEL</button>
      <button class="button b-sp-color" onclick="addOperator('%')">%</button>
      <button class="button b-color" onclick="addOperator('/')">/</button>

      <button class="button" onclick="
      if (justCalculated) { currentDisplay = ''; justCalculated = false; }
      currentDisplay = currentDisplay + '7';
      document.querySelector('#display').value = currentDisplay;
      ">7</button>
      <button class="button" onclick="
      if (justCalculated) { currentDisplay = ''; justCalculated = false; }
      currentDisplay = currentDisplay + '8';
      document.querySelector('#display').value = currentDisplay;
      ">8</button>
      <button class="button" onclick="
       if (justCalculated) { currentDisplay = ''; justCalculated = false; }
      currentDisplay = currentDisplay + '9';
      document.querySelector('#display').value = currentDisplay;
      ">9</button>
      <button class="button b-color" onclick="addOperator('*')">*</button>

      <button class="button" onclick="
      if (justCalculated) { currentDisplay = ''; justCalculated = false; }
      currentDisplay = currentDisplay + '4';
      document.querySelector('#display').value = currentDisplay;
      ">4</button>
      <button class="button" onclick="
      if (justCalculated) { currentDisplay = ''; justCalculated = false; }
      currentDisplay = currentDisplay + '5';
      document.querySelector('#display').value = currentDisplay;
      ">5</button>
      <button class="button" onclick="
      if (justCalculated) { currentDisplay = ''; justCalculated = false; }
      currentDisplay = currentDisplay + '6';
      document.querySelector('#display').value = currentDisplay;
      ">6</button>
      <button class="button b-color" onclick="addOperator('-')">-</button>


      <button class="button" onclick="
      if (justCalculated) { currentDisplay = ''; justCalculated = false; }
      currentDisplay = currentDisplay + '1';
      document.querySelector('#display').value = currentDisplay;
      ">1</button>
      <button class="button" onclick="
      if (justCalculated) { currentDisplay = ''; justCalculated = false; }
      currentDisplay = currentDisplay + '2';
      document.querySelector('#display').value = currentDisplay;
      ">2</button>
      <button class="button" onclick="
      if (justCalculated) { currentDisplay = ''; justCalculated = false; }
      currentDisplay = currentDisplay + '3';
      document.querySelector('#display').value = currentDisplay;
      ">3</button>
      <button class="button b-color" onclick="addOperator('+')">+</button>

      <button id="button-zero" class="button" onclick="
       if (justCalculated) { currentDisplay = ''; justCalculated = false; }
      currentDisplay = currentDisplay + '0';
      document.querySelector('#display').value = currentDisplay;
      ">0</button>
      <button class="button" onclick="
      if (justCalculated && !continuedAfterOperator) {
      currentDisplay = '';
      justCalculated = false;
      }
      currentDisplay = currentDisplay + '.';
      document.querySelector('#display').value = currentDisplay;
      ">.</button>
      <button id="b-eq-color" class="button" onclick="calculate()">=</button>

    </div>
  </div>
  <script>
    let justCalculated = false;
    let continuedAfterOperator = false;
    let currentDisplay = '';
    let lastResult = '';
    const ops = ['+', '-', '*', '/', '%'];

    function addOperator(op) {
      if (justCalculated) {
        currentDisplay = lastResult + op; // continue from result
        justCalculated = false;
        continuedAfterOperator = true;
      } else if (ops.includes(currentDisplay.slice(-1))) {
        currentDisplay = currentDisplay.slice(0, -1) + op;
      } else {
        currentDisplay += op;
      }
      document.querySelector('#display').value = currentDisplay;
    }

    function calculate() {
      try {
        lastResult = eval(currentDisplay); // store the result
        document.querySelector('#display').value = lastResult;
        currentDisplay = String(lastResult);
        justCalculated = true;
        continuedAfterOperator = false;
      } catch {
        document.querySelector('#display').value = "Error";
      }
    }

  </script>
</body>

</html>